# MyAssetSheet ユーザーマニュアル

自宅の耐久消費財を管理するための macOS アプリケーションです。
購入履歴・耐用年数・費用を一覧とダッシュボードで確認できます。

---

## 目次

1. [画面構成](#画面構成)
2. [一覧画面](#一覧画面)
3. [資産の登録・編集](#資産の登録編集)
4. [除却（処分済み）管理](#除却処分済み管理)
5. [CSV 取込（インポート）](#csv-取込インポート)
6. [CSV 出力（エクスポート）](#csv-出力エクスポート)
7. [ダッシュボード](#ダッシュボード)
8. [メニューバー](#メニューバー)
9. [分類と耐用年数の一覧](#分類と耐用年数の一覧)
10. [データの保存場所](#データの保存場所)

---

## 画面構成

アプリは 2 つのタブで構成されています。

| タブ | 説明 |
|------|------|
| **一覧** | 登録した資産を表形式で一覧表示します |
| **ダッシュボード** | グラフで資産の状況を視覚的に確認できます |

画面上部のタブをクリックして切り替えます。

---

## 一覧画面

登録した耐久消費財を一覧表示する画面です。

### 表示項目

| 列名 | 説明 |
|------|------|
| 分類 | 家電カテゴリ（テレビ、冷蔵庫など） |
| 製品 | 製品名 |
| 購入店 | 購入した店舗名 |
| 購入日 | 購入した日付 |
| 購入金額 | 購入金額（円） |
| 経過日数 | 購入日から現在までの日数（自動計算） |
| 経過年数 | 購入日から現在までの年数（自動計算） |
| 日額費用 | 1日あたりの費用 = 購入金額 ÷ 経過日数（自動計算） |
| 耐用年数 | 製品の想定使用年数 |
| 備考 | 自由記入欄 |

### 列の並べ替え

各列のヘッダーをクリックすると、その列の値で昇順・降順に並べ替えができます。

### 色による状態表示

- **経過年数が赤字**: 耐用年数を超過していることを示します（買い替え検討の目安）
- **行がグレー表示**: 除却済み（処分済み）の資産です
- **日額費用が「-」**: 購入金額が 0 円または不明の場合

### ツールバーボタン

一覧画面の上部にあるツールバーのアイコンを使って操作します。
各アイコンにマウスカーソルを合わせると、機能の説明がツールチップとして表示されます。

| アイコン | 機能 | 説明 |
|----------|------|------|
| 👁 (目) | 除却表示/非表示 | 除却済みの資産の表示・非表示を切り替えます |
| ＋ | 新規追加 | 新しい資産を登録する画面を開きます |
| ↓ | CSV取込 | CSV ファイルからデータを取り込みます |
| ↑ | CSV出力 | データを CSV ファイルとして出力します |
| 🗑 | 削除 | 選択した資産を削除します |

---

## 資産の登録・編集

### 新規登録

1. ツールバーの **＋** ボタンをクリック
2. 各項目を入力
   - **分類**: ドロップダウンから選択（「その他」を選ぶと自由入力が可能）
   - **製品**: 製品名を入力（必須）
   - **購入店**: 購入した店舗名を入力
   - **購入日**: カレンダーから日付を選択
   - **購入金額**: 金額を数字で入力
   - **耐用年数**: 分類を選択すると自動入力されます（手動で変更可能）
   - **備考**: 自由記入
   - **除却済み**: 処分済みの場合はオンに
3. **保存** ボタンをクリック

### 編集

- 一覧の行を **ダブルクリック** すると編集画面が開きます
- または、行を **右クリック** → **編集** を選択

### 削除

1. 一覧で削除したい行を選択（クリック）
2. ツールバーの **🗑（ゴミ箱）** ボタンをクリック
- または、行を **右クリック** → **削除** を選択

---

## 除却（処分済み）管理

使わなくなった製品を「除却済み」としてマークできます。

### 除却済みにする

- 一覧で対象の行を **右クリック** → **除却済みにする** を選択

### 除却を解除する

- 除却済みの行を **右クリック** → **除却を解除** を選択

### 除却済みの表示・非表示

- ツールバーの **目のアイコン** をクリックして、除却済み資産の表示/非表示を切り替えます

### 除却済み資産の表示

- 行がグレー（半透明）で表示されます
- 経過日数・経過年数・日額費用は「-」と表示されます
- 備考欄の先頭に「除却済み」と表示されます

---

## CSV 取込（インポート）

外部の CSV ファイルからデータを一括で取り込むことができます。

### 操作方法

- ツールバーの **↓（CSV取込）** ボタンをクリック
- または、メニューバー **ファイル** → **CSV 取込...** （⇧⌘I）

### CSV フォーマット

```
分類,製品,購入店,購入日,購入金額,耐用年数,備考
テレビ,REGZA 55X9900M,ヨドバシカメラ,2024/01/15,198000,8,リビング用
```

| 列番号 | 項目 | 備考 |
|--------|------|------|
| 1 | 分類 | テキスト |
| 2 | 製品 | テキスト（必須） |
| 3 | 購入店 | テキスト |
| 4 | 購入日 | yyyy/MM/dd, yyyy-MM-dd, yyyy.MM.dd, yyyy年MM月dd日 に対応 |
| 5 | 購入金額 | 数値（カンマ区切り可） |
| 6 | 耐用年数 | 数値（年） |
| 7 | 備考 | テキスト（「除却済み」を含むと除却フラグが自動で設定されます） |

### 注意事項

- 1行目がヘッダー行（「分類」または「製品」を含む行）の場合、自動でスキップされます
- カンマを含む値はダブルクォート `"..."` で囲んでください
- ダブルクォート内のダブルクォートは `""` でエスケープしてください
- 取り込んだデータは既存のデータに**追加**されます（上書きではありません）

---

## CSV 出力（エクスポート）

登録されているすべてのデータを CSV ファイルとして出力できます。

### 操作方法

- ツールバーの **↑（CSV出力）** ボタンをクリック
- または、メニューバー **ファイル** → **CSV 出力...** （⇧⌘E）

### 出力フォーマット

取込と同じ 7 列のフォーマットで出力されます。
除却済みの資産は備考欄に「除却済み」が付加されます。

出力した CSV ファイルは、そのまま再取込（インポート）が可能です。

---

## ダッシュボード

資産の状況をグラフで視覚的に確認できる画面です。

### サマリーカード

画面上部に 4 つの概要カードが表示されます。

| カード | 説明 |
|--------|------|
| 稼働中 | 現在使用中の資産数 |
| 除却済み | 除却（処分済み）の資産数 |
| 稼働中 合計金額 | 稼働中の資産の購入金額の合計 |
| 耐用年数 超過 | 耐用年数を超えている資産数 |

### 年別 購入推移（棒グラフ）

稼働中の資産を購入年ごとに集計し、棒グラフで表示します。
各年にいくら投資したかを把握できます。

### 耐用年数 消化率（横棒グラフ）

各資産の耐用年数に対する経過年数の割合を表示します。

- **緑**: 75% 以下 — まだ余裕あり
- **黄〜オレンジ**: 75〜100% — 買い替えが近い
- **赤**: 100% 超 — 耐用年数を超過
- 赤い点線が **100%（耐用年数到達）** の基準線です

---

## メニューバー

### MyAssetSheet メニュー

| メニュー項目 | 説明 |
|------------|------|
| MyAssetSheet について | バージョン情報とアプリの説明を表示 |

### ファイルメニュー

| メニュー項目 | ショートカット | 説明 |
|------------|------------|------|
| CSV 取込... | ⇧⌘I | CSV ファイルからデータを取り込む |
| CSV 出力... | ⇧⌘E | データを CSV ファイルとして出力する |

---

## 分類と耐用年数の一覧

分類を選択すると、以下のデフォルト耐用年数が自動入力されます。
手動で変更することも可能です。

| 分類 | デフォルト耐用年数 | 根拠 |
|------|-------------------|------|
| テレビ | 8年 | メーカー補修部品保有 8年 |
| 冷蔵庫 | 10年 | 補修部品保有 9年、実使用 10〜15年 |
| 洗濯機 | 7年 | 補修部品保有 6〜7年 |
| 掃除機 | 7年 | 補修部品保有 6年 |
| エアコン | 10年 | 補修部品保有 10年 |
| 電子レンジ | 10年 | 補修部品保有 8年 |
| 炊飯器 | 6年 | 補修部品保有 6年 |
| 食洗機 | 7年 | 補修部品保有 6年 |
| PC | 4年 | 法定耐用年数 4年 |
| タブレット | 4年 | 法定耐用年数 4年 |
| スマートフォン | 3年 | 実使用 3〜4年 |
| 時計 | 10年 | 種類による、電池式 5〜10年 |
| カメラ | 5年 | 法定耐用年数 5年 |
| プリンター/複合機 | 5年 | 法定耐用年数 5年 |
| スキャナー | 5年 | 法定耐用年数 5年 |
| ルータ/ネットワーク | 5年 | 法定耐用年数 5年 |
| オーディオ | 7年 | 補修部品保有 8年 |
| 照明 | 10年 | LED 10年以上 |
| 家具 | 10年 | 法定耐用年数 8〜15年 |
| その他 | — | 手動で入力してください |

---

## データの保存場所

データは以下のフォルダに JSON 形式で自動保存されます。

```
~/Library/Application Support/MyAssetSheet/assets.json
```

- アプリの起動時に自動で読み込まれます
- データの追加・編集・削除のたびに自動保存されます
- バックアップが必要な場合は、上記ファイルをコピーするか、CSV 出力機能をご利用ください

---

## 動作環境

- **対応 OS**: macOS 13 (Ventura) 以降
- **アーキテクチャ**: Apple Silicon / Intel (Universal)
